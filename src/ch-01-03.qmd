# Chapters 1-3

## About

This page summarizes work related to chapters 1-3 of *Statistical Rethinking* [-@McElreath2020-fg].

## Setup

Source libraries for more efficient and readable code.

```{r}
suppressPackageStartupMessages(library(ggplot2))
```

## Components of the model

See [-@McElreath2020-fg pp. 32-35].

$$ Pr(W,L|p)=\frac{(W+L)!}{W!L!}p^W(1-p)^L $$ {#eq-cond-p-W-L}

The probability of $W$ and $L$, conditional on $p$ is defined by the formula in @eq-cond-p-W-L.

The `dbinom()` function computes this binomial probability.
To compute the probability of observing $x=6$ $W$s in 9 globe tosses with $p=4$, we proceed as indicated below:

```{r}
#| echo: fenced
#| code-fold: false
dbinom(x = 6, size = 9, prob = 0.5, log = FALSE)
```

So, to compute the binomial probabilities for observing all $n+1$ possible cases, we proceed as follows:

```{r}
#| echo: fenced
#| code-fold: false

# Generate the data
n_W <- 0:9
p_n <- purrr::map(n_W, dbinom, size = 9, prob = 0.5, log = FALSE) |>
  purrr::list_c()

like_1 <- data.frame(n_obs = n_W, p_n = p_n)

# Plot the data
like_1 |>
  ggplot() +
  geom_point(aes(x = n_obs, y = p_n)) +
  theme_classic()
```

To produce a set of binomial plots based on increasing numbers of samples, we proceed as follows.

```{r}
#| echo: fenced
#| code-fold: false

# Generate the data
n_samples <- c(1, 2, 4, 8, 16, 32, 64)

how_many_W <- function(n) 0:n
n_W <- purrr::map(n_samples, how_many_W) |>
  purrr::list_c()

n_states <- rep(n_samples, n_samples+1)

p_n <- purrr::map2(n_W, n_states, dbinom, prob = 0.5, log = FALSE) |>
  purrr::list_c()

like_2 <- data.frame(n_states = n_states, n_W = n_W, p_n = p_n)
```

```{r}
like_2 |>
  ggplot() +
  geom_point(aes(x = n_W, y = p_n)) +
  facet_wrap(n_states, ncol = 3) +
  theme_classic() +
  ggtitle("Probability density as number of samples increases.")
```

So, this figure isn't quite what I want. But it's a start.
What I think I want is a graph that plots the proportion of times $W$ was picked out of $n$ samples vs. the probability density. 

```{r}
#| echo: fenced
#| code-fold: false

# Generate the data
n_samples <- c(1, 2, 4, 8, 16, 32, 64)

how_many_W <- function(n) 0:n
n_W <- purrr::map(n_samples, how_many_W) |>
  purrr::list_c()

n_states <- rep(n_samples, n_samples+1)

p_W <- n_W/n_states

p_n <- purrr::map2(n_W, n_states, dbinom, prob = 0.5, log = FALSE) |>
  purrr::list_c()

like_3 <- data.frame(n_states = n_states, n_W = n_W, p_W = p_W, p_n = p_n)
```

```{r}
like_3 |>
  ggplot() +
  geom_point(aes(x = p_W, y = p_n)) +
  facet_wrap(n_states, ncol = 3) +
  theme_classic() +
  ggtitle("Probability density for a given proportion of W's as number of samples increases.")
```

Yes. That's it.
